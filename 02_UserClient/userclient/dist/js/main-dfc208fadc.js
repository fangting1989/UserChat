angular.module("starter",["ionic","starter.controllers","starter.services","starter.routers","starter.directives","starter.filters"]).run(["$ionicPlatform",function($ionicPlatform){$ionicPlatform.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}]);
angular.module("starter.controllers",[]).controller("loginCtrl",["$scope","deepstreamservice",function($scope,deepstreamservice){$scope.TitleName="123"}]).controller("chatCtrl",["$scope","deepstreamservice","$stateParams",function($scope,deepstreamservice,$stateParams){$scope.TitleName="联系方式"}]);
angular.module("starter.directives",[]).directive("popupKeyboard",["$timeout","$parse",function($timeout,$parse){return{restrict:"AE",replace:!1,link:function(scope,element,attr){angular.element(element).css({transition:"transform 0.22s ease"}),window.addEventListener("native.keyboardshow",function(e){var transformY=-150,modelData=$parse(attr.popupKeyboard);transformY="undefined"==typeof modelData()?-150:modelData(),angular.element(element).css({transform:"translateY("+transformY+"px)"})})}}}]);
angular.module("starter.filters",[]);
angular.module("starter.routers",[]).config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$stateProvider.state("login",{url:"/login",templateUrl:"templates/login.html",controller:"loginCtrl"}).state("chat",{url:"/chat",templateUrl:"templates/chat.html",controller:"chatCtrl"}),$urlRouterProvider.otherwise("/chat")}]);
angular.module("starter.services",[]).service("deepstreamservice",["$q","$rootScope",function($q,$rootScope){function doinit(cb){var defered=$q.defer();return ds=deepstream(globleService.ChannelApi+":6020",{rpcAckTimeout:3e4,rpcResponseTimeout:6e4,path:"/deepstream"}),ds.on("error",function(msg,event,topic){"connectionError"===event&&(cb&&cb(),defered.resolve(!1))}),ds.on("connectionStateChanged",function(connectionState){console.log("FTFT--1");var connection=ds._connection;"RECONNECTING"===connectionState&&connection._reconnectionAttempt>=connection._options.maxReconnectAttempts-1&&(console.log("FTFT--2"),connection._reconnectionAttempt=0)}),ds.login({},function(success,errorCode,data){initedflag=!0,defered.resolve(ds)}),defered.promise}function init(cb){return console.log("FTFT"),initedflag?$q.when(ds):doinit(cb)}function getds(){return ds}var ds,initedflag;return{init:init,getds:getds}}]).service("chatservice",["deepstreamservice","$q",function(deepstreamservice,$q){var deferred=$q.defer();return{Init:function(chatname){deepstreamservice.init().then(function(ds){if(ds){var systemR=ds.record.getRecord("wechat");systemR.whenReady(function(){systemR.subscribe(function(info){console.log("data--subscribe"),info&&(localStorageService.set("storeInfo",info),angular.extend(serviceConfig,info),localStorageService.set("serviceConfig",serviceConfig))},!0),deferred.resolve()})}else deferred.reject()})}}}]);